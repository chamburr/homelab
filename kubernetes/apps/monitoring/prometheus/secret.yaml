---
apiVersion: ricoberger.de/v1alpha1
kind: VaultSecret
metadata:
  name: prometheus-secret
  namespace: monitoring
spec:
  keys:
    - username
    - password
    - password_hash
  templates:
    username: "{% .Secrets.username %}"
    password: "{% .Secrets.password %}"
    web-config.yaml: |
      basic_auth_users:
        {% .Secrets.username %}: {% .Secrets.password_hash %}
  path: secret/monitoring/prometheus
  type: Opaque
---
apiVersion: v1
kind: Secret
metadata:
  name: prometheus-prometheus-web-config
  namespace: monitoring
  annotations:
    kustomize.toolkit.fluxcd.io/ssa: merge
    reflector.v1.k8s.emberstack.com/reflects: monitoring/prometheus-secret
